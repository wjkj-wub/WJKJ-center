!function(a){var b={title:"",index:200,opacity:.8,sureBtnTxt:"\u786e\u5b9a",width:"auto",height:"auto",bar:!0,bg:!0,btnclose:!0,fix:!1,bgclose:!1,drag:!1,ajaxTagA:!0,protect:"auto",onshow:a.noop,onclose:a.noop,delay:0},c='<div id="iboxOverlay" onselectstart="return false;"></div><div class="wrap_out" id="wrapOut"><div id="wrapBar" class="wrap_bar" onselectstart="return false;"><h4 id="wrapTitle" class="wrap_title"></h4><a id="wrapClose" class="wrap_close" href="javasctipt:" title="\u5173\u95ed"></a></div><div id="wrapMain"></div></div>';a.fn.Ibox=function(c){c=c||{};var d=a.extend({},b,c);return this.each(function(){var b=this.nodeName.toLowerCase();"a"===b&&d.ajaxTagA?a(this).click(function(){var b=a.trim(a(this).attr("href"));if(b&&0!=b.indexOf("javascript:"))if(0===b.indexOf("#"))a.Ibox(a(b),c);else{a.Ibox.loading();var d=new Image;d.onload=function(){var e=d.width,f=d.height;e>0&&(c.protect=!1,a.Ibox(a('<img src="'+b+'" width="'+e+'" height="'+f+'" />'),c))},d.onerror=function(){a.Ibox.ajax(b,{},c)},d.src=b}return!1}):a.Ibox(a(this),c)})},a.Ibox=function(d,e){if(d){var f=a.extend({},b,e||{}),g=a("#wrapOut"),h=a("#iboxOverlay");g.size()?(g.show(),h[f.bg?"show":"hide"]()):(a("body").append(c),g=a("#wrapOut")),"object"==typeof d?d.show():d=a(d),a.o={s:f,ele:d,bg:h.size()?h:a("#iboxOverlay"),out:g,tit:g.find("#wrapTitle"),bar:g.find("#wrapBar"),clo:g.find("#wrapClose"),main:g.find("#wrapMain")},a.o.tit.html(f.title),a.o.main.empty().append(d),a.isFunction(f.onshow)&&f.onshow(),a.Ibox.setSize(),a.Ibox.setPosition(),f.fix&&a.Ibox.setFixed(),f.drag?a.Ibox.drag():a(window).resize(function(){a.Ibox.setPosition()}),f.bar?a.Ibox.barShow():a.Ibox.barHide(),f.bg?a.Ibox.bgShow():a.Ibox.bgHide(),f.btnclose?a.o.clo.click(function(){return a.Ibox.hide(),!1}):a.Ibox.closeBtnHide(),f.bgclose&&a.Ibox.bgClickable(),f.delay>0&&setTimeout(a.Ibox.hide,f.delay)}},a.extend(a.Ibox,{setSize:function(){return a.o.main.size()&&a.o.ele.size()&&a.o.main.size()?(a.o.out.css({width:a.o.s.width,"height:":a.o.s.height}),a.o.out):void 0},setPosition:function(b){if(b=b||!1,a.o.bg.size()&&a.o.ele.size()&&a.o.out.size()){var c=a(window).width(),d=a(window).height(),e=a(window).scrollTop(),f=a("body").height();d>f&&(f=d),a.o.bg.width(c).height(f).css("opacity",a.o.s.opacity);var g=a.o.out.outerHeight(),h=a.o.out.outerWidth(),i=e+(d-g)/2,j=(c-h)/2;return a.o.s.fix&&window.XMLHttpRequest&&(i=(d-g)/2),b===!0?a.o.out.animate({top:i,left:j}):a.o.out.css({top:i,left:j,zIndex:a.o.s.index}),a.o.out}},setFixed:function(){return a.o.out&&a.o.out.size()?(window.XMLHttpRequest?a.Ibox.setPosition().css({position:"fixed"}):a(window).scroll(function(){a.Ibox.setPosition()}),a.o.out):void 0},bgClickable:function(){a.o.bg&&a.o.bg.size()&&a.o.bg.click(function(){a.Ibox.hide()})},bgHide:function(){a.o.bg&&a.o.bg.size()&&a.o.bg.hide()},bgShow:function(){a.o.bg&&a.o.bg.size()?a.o.bg.show():a('<div id="iboxOverlay"></div>').prependTo("body")},barHide:function(){a.o.bar&&a.o.bar.size()&&a.o.bar.hide()},barShow:function(){a.o.bar&&a.o.bar.size()&&a.o.bar.show()},closeBtnHide:function(){a.o.clo&&a.o.clo.size()&&a.o.clo.hide()},hide:function(){return a.o.ele&&a.o.out.size()&&"none"!==a.o.out.css("display")&&(a.o.out.fadeOut("fast",function(){!a.o.s.protect||a.o.ele.hasClass("wrap_content")&&!a.o.ele.attr("id")||a.o.ele.hide().appendTo(a("body")),a(this).remove(),a.isFunction(a.o.s.onclose)&&a.o.s.onclose()}),a.o.bg.size()&&a.o.bg.fadeOut("fast",function(){a(this).remove()})),!1},drag:function(){if(!a.o.out.size()||!a.o.bar.size())return a(document).unbind("mouseover").unbind("mouseup"),void 0;var b=a.o.bar,c=a.o.out,d=!1,e=0,f=0,g=c.css("left"),h=c.css("top");b.mousedown(function(a){d=!0,e=a.pageX,f=a.pageY}).css("cursor","move"),a(document).mousemove(function(a){if(d){var b=a.pageX,i=a.pageY,j=b-e,k=i-f;c.css("left",parseInt(g)+j).css("top",parseInt(h)+k)}}),a(document).mouseup(function(){d=!1,g=c.css("left"),h=c.css("top")})},loading:function(){a.Ibox(a('<div class="wrap_content">\u52a0\u8f7d\u4e2d...</div>'),{bar:!1})},confirm:function(b,c,d,e){a.Ibox(a('<div class="wrap_content">'+b+'</div><div class="warp_button"><a id="iboxSureBtn" class="bluebtn btn mr20" href="javascript:;"></a><a id="iboxCancelBtn" class="graybtn btn" href="javascript:;">\u53d6\u6d88</a></div>'),e),a("#iboxSureBtn").html(a.o.s.sureBtnTxt).click(function(){a.isFunction(c)&&c.call(this)}),a("#iboxCancelBtn").click(function(){d&&a.isFunction(d)&&d.call(this),a.Ibox.hide()})},open:function(b,c,d){a.Ibox(a('<div class="wrap_content">'+b+'</div><div class="warp_button"><a id="iboxSureBtn" class="bluebtn btn" href="javascript:;"></a></div>'),d),a("#iboxSureBtn").html(a.o.s.sureBtnTxt).click(function(){c&&a.isFunction(c)&&c.call(this),a.Ibox.hide()})},ajax:function(b,c,d){b&&(a.Ibox.loading(),d=d||{},d.protect=!1,a.ajax({url:b,data:c||{},success:function(b){a.Ibox(b,d)},error:function(){a.Ibox.open("\u52a0\u8f7d\u51fa\u4e86\u70b9\u95ee\u9898\u3002")}}))}})}(jQuery);